@startuml
'https://plantuml.com/class-diagram

package "IDMP Datamodel" as idmpDatamodel <<frame>> {
    entity EdqmRouteOfAdministration {
        * code: String
        --
        * display: String
    }

    entity EdqmUnitOfPresentation {
        * code: String
        --
        * display: String
    }

    together {
        entity EdqmDoseForm {
            * code: String
            --
            * doseFormType: String
            * display: String
        }

        entity Strength {
            * id: Long <<generated>>
            --
            * referenceNumeratorValue: Float
            * referenceNumeratorUnit: Unit
            referenceDenominatorValue: Float
            referenceDenominatorUnit: Unit
            numeratorValue: Float
            numeratorUnit: Unit
            denominatorValue: Float
            denominatorUnit: Unit
            * isPresentationStrength: Boolean
        }

        entity SubstanceWithRolePai {
            * id: Long <<generated>>
            --
            * ingredientCode: String <<unique>>
            * moiety: String
            modifier: String
        }

        entity VirtualMedicinalProductGroup {
            * code: String
            --
            * label: String
        }

        note right of Strength {
            **Strength:** both moiety and modifier
            **Reference strength:** moiety only
        }
    }

    entity PharmaceuticalProduct {
        * id: Long <<generated>>
        --
        phpId: String <<unique>>
    }

    entity MedicinalProduct {
        * id: Long <<generated>>
        --
        mpId: String <<unique>>
        * country: Country
        * fullName: String
        packDescription: String
    }

    entity PackagedMedicinalProduct {
        * id: Long <<generated>>
        --
        pcId: String <<unique>>
        * packageSize: Integer
        * atcCode: String
    }

    entity Organization {
        * id: Long <<generated>>
        --
        * name: String
    }

    EdqmUnitOfPresentation ||-o{ PharmaceuticalProduct : unitOfPresentation

    SubstanceWithRolePai ||---o{ PharmaceuticalProduct : preciseActiveIngredient
    EdqmDoseForm ||---o{ PharmaceuticalProduct : pharmaceuticalDoseForm
    Strength ||---o| PharmaceuticalProduct : normalizedStrength
    VirtualMedicinalProductGroup ||---o| PharmaceuticalProduct : virtualMedicnalProductGroup

    PharmaceuticalProduct ||--o{ MedicinalProduct : pharmaceuticalProduct

    MedicinalProduct ||--o{ PackagedMedicinalProduct : medicinalProduct
    MedicinalProduct }o--|| EdqmDoseForm : administrableDoseForm
    EdqmRouteOfAdministration }o-o{ MedicinalProduct : routesOfAdministration

    MedicinalProduct }o-|| Organization : marketingAuthorizationHolder


}

note top of idmpDatamodel {
    Not in sync with spring entities
}
@enduml